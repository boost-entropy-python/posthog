# serializer version: 1
# name: TestTrafficTypeSnapshot.test_filter_bots_sql_query
  '''
  -- ClickHouse
  
  SELECT
      events.event AS event,
      replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_0)s), ''), 'null'), '^"|"$', '') AS user_agent
  
  FROM
      events
  
  WHERE
      and(equals(events.team_id, 99999), equals(events.event, %(hogql_val_1)s), not(or(match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_2)s), ''), 'null'), '^"|"$', ''), %(hogql_val_3)s), %(hogql_val_4)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_5)s), ''), 'null'), '^"|"$', ''), %(hogql_val_6)s), %(hogql_val_7)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_8)s), ''), 'null'), '^"|"$', ''), %(hogql_val_9)s), %(hogql_val_10)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_11)s), ''), 'null'), '^"|"$', ''), %(hogql_val_12)s), %(hogql_val_13)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_14)s), ''), 'null'), '^"|"$', ''), %(hogql_val_15)s), %(hogql_val_16)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_17)s), ''), 'null'), '^"|"$', ''), %(hogql_val_18)s), %(hogql_val_19)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_20)s), ''), 'null'), '^"|"$', ''), %(hogql_val_21)s), %(hogql_val_22)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_23)s), ''), 'null'), '^"|"$', ''), %(hogql_val_24)s), %(hogql_val_25)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_26)s), ''), 'null'), '^"|"$', ''), %(hogql_val_27)s), %(hogql_val_28)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_29)s), ''), 'null'), '^"|"$', ''), %(hogql_val_30)s), %(hogql_val_31)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_32)s), ''), 'null'), '^"|"$', ''), %(hogql_val_33)s), %(hogql_val_34)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_35)s), ''), 'null'), '^"|"$', ''), %(hogql_val_36)s), %(hogql_val_37)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_38)s), ''), 'null'), '^"|"$', ''), %(hogql_val_39)s), %(hogql_val_40)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_41)s), ''), 'null'), '^"|"$', ''), %(hogql_val_42)s), %(hogql_val_43)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_44)s), ''), 'null'), '^"|"$', ''), %(hogql_val_45)s), %(hogql_val_46)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_47)s), ''), 'null'), '^"|"$', ''), %(hogql_val_48)s), %(hogql_val_49)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_50)s), ''), 'null'), '^"|"$', ''), %(hogql_val_51)s), %(hogql_val_52)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_53)s), ''), 'null'), '^"|"$', ''), %(hogql_val_54)s), %(hogql_val_55)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_56)s), ''), 'null'), '^"|"$', ''), %(hogql_val_57)s), %(hogql_val_58)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_59)s), ''), 'null'), '^"|"$', ''), %(hogql_val_60)s), %(hogql_val_61)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_62)s), ''), 'null'), '^"|"$', ''), %(hogql_val_63)s), %(hogql_val_64)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_65)s), ''), 'null'), '^"|"$', ''), %(hogql_val_66)s), %(hogql_val_67)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_68)s), ''), 'null'), '^"|"$', ''), %(hogql_val_69)s), %(hogql_val_70)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_71)s), ''), 'null'), '^"|"$', ''), %(hogql_val_72)s), %(hogql_val_73)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_74)s), ''), 'null'), '^"|"$', ''), %(hogql_val_75)s), %(hogql_val_76)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_77)s), ''), 'null'), '^"|"$', ''), %(hogql_val_78)s), %(hogql_val_79)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_80)s), ''), 'null'), '^"|"$', ''), %(hogql_val_81)s), %(hogql_val_82)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_83)s), ''), 'null'), '^"|"$', ''), %(hogql_val_84)s), %(hogql_val_85)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_86)s), ''), 'null'), '^"|"$', ''), %(hogql_val_87)s), %(hogql_val_88)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_89)s), ''), 'null'), '^"|"$', ''), %(hogql_val_90)s), %(hogql_val_91)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_92)s), ''), 'null'), '^"|"$', ''), %(hogql_val_93)s), %(hogql_val_94)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_95)s), ''), 'null'), '^"|"$', ''), %(hogql_val_96)s), %(hogql_val_97)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_98)s), ''), 'null'), '^"|"$', ''), %(hogql_val_99)s), %(hogql_val_100)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_101)s), ''), 'null'), '^"|"$', ''), %(hogql_val_102)s), %(hogql_val_103)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_104)s), ''), 'null'), '^"|"$', ''), %(hogql_val_105)s), %(hogql_val_106)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_107)s), ''), 'null'), '^"|"$', ''), %(hogql_val_108)s), %(hogql_val_109)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_110)s), ''), 'null'), '^"|"$', ''), %(hogql_val_111)s), %(hogql_val_112)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_113)s), ''), 'null'), '^"|"$', ''), %(hogql_val_114)s), %(hogql_val_115)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_116)s), ''), 'null'), '^"|"$', ''), %(hogql_val_117)s), %(hogql_val_118)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_119)s), ''), 'null'), '^"|"$', ''), %(hogql_val_120)s), %(hogql_val_121)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_122)s), ''), 'null'), '^"|"$', ''), %(hogql_val_123)s), %(hogql_val_124)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_125)s), ''), 'null'), '^"|"$', ''), %(hogql_val_126)s), %(hogql_val_127)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_128)s), ''), 'null'), '^"|"$', ''), %(hogql_val_129)s), %(hogql_val_130)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_131)s), ''), 'null'), '^"|"$', ''), %(hogql_val_132)s), %(hogql_val_133)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_134)s), ''), 'null'), '^"|"$', ''), %(hogql_val_135)s), %(hogql_val_136)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_137)s), ''), 'null'), '^"|"$', ''), %(hogql_val_138)s), %(hogql_val_139)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_140)s), ''), 'null'), '^"|"$', ''), %(hogql_val_141)s), %(hogql_val_142)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_143)s), ''), 'null'), '^"|"$', ''), %(hogql_val_144)s), %(hogql_val_145)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_146)s), ''), 'null'), '^"|"$', ''), %(hogql_val_147)s), %(hogql_val_148)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_149)s), ''), 'null'), '^"|"$', ''), %(hogql_val_150)s), %(hogql_val_151)s))))
  ORDER BY
      user_agent ASC
  
  LIMIT 100 
  SETTINGS readonly=2, max_execution_time=60, allow_experimental_object_type=1, format_csv_allow_double_quotes=0, max_ast_elements=4000000, max_expanded_ast_elements=4000000, max_bytes_before_external_group_by=0, transform_null_in=1, optimize_min_equality_disjunction_chain_length=4294967295, allow_experimental_join_condition=1, use_hive_partitioning=0
  
  -- HogQL
  
  SELECT
      event,
      properties.$user_agent AS user_agent
  
  FROM
      events
  
  WHERE
      and(equals(event, '$pageview'), not(or(match(ifNull(properties.$user_agent, ''), 'GPTBot'), match(ifNull(properties.$user_agent, ''), 'ChatGPT-User'), match(ifNull(properties.$user_agent, ''), 'ClaudeBot'), match(ifNull(properties.$user_agent, ''), 'anthropic-ai'), match(ifNull(properties.$user_agent, ''), 'PerplexityBot'), match(ifNull(properties.$user_agent, ''), 'Google-Extended'), match(ifNull(properties.$user_agent, ''), 'CCBot'), match(ifNull(properties.$user_agent, ''), 'Applebot-Extended'), match(ifNull(properties.$user_agent, ''), 'cohere-ai'), match(ifNull(properties.$user_agent, ''), 'meta-externalagent'), match(ifNull(properties.$user_agent, ''), 'Bytespider'), match(ifNull(properties.$user_agent, ''), 'Googlebot'), match(ifNull(properties.$user_agent, ''), 'Bingbot'), match(ifNull(properties.$user_agent, ''), 'YandexBot'), match(ifNull(properties.$user_agent, ''), 'Baiduspider'), match(ifNull(properties.$user_agent, ''), 'DuckDuckBot'), match(ifNull(properties.$user_agent, ''), 'Slurp'), match(ifNull(properties.$user_agent, ''), 'AhrefsBot'), match(ifNull(properties.$user_agent, ''), 'SemrushBot'), match(ifNull(properties.$user_agent, ''), 'MJ12bot'), match(ifNull(properties.$user_agent, ''), 'DotBot'), match(ifNull(properties.$user_agent, ''), 'PetalBot'), match(ifNull(properties.$user_agent, ''), 'facebookexternalhit'), match(ifNull(properties.$user_agent, ''), 'Twitterbot'), match(ifNull(properties.$user_agent, ''), 'LinkedInBot'), match(ifNull(properties.$user_agent, ''), 'Pinterest'), match(ifNull(properties.$user_agent, ''), 'Slackbot'), match(ifNull(properties.$user_agent, ''), 'TelegramBot'), match(ifNull(properties.$user_agent, ''), 'WhatsApp'), match(ifNull(properties.$user_agent, ''), 'Pingdom'), match(ifNull(properties.$user_agent, ''), 'UptimeRobot'), match(ifNull(properties.$user_agent, ''), 'Site24x7'), match(ifNull(properties.$user_agent, ''), 'StatusCake'), match(ifNull(properties.$user_agent, ''), 'Datadog'), match(ifNull(properties.$user_agent, ''), 'curl/'), match(ifNull(properties.$user_agent, ''), 'Wget'), match(ifNull(properties.$user_agent, ''), 'python-requests'), match(ifNull(properties.$user_agent, ''), 'axios'), match(ifNull(properties.$user_agent, ''), 'node-fetch'), match(ifNull(properties.$user_agent, ''), 'Go-http-client'), match(ifNull(properties.$user_agent, ''), 'okhttp'), match(ifNull(properties.$user_agent, ''), 'Apache-HttpClient'), match(ifNull(properties.$user_agent, ''), 'libwww-perl'), match(ifNull(properties.$user_agent, ''), 'Scrapy'), match(ifNull(properties.$user_agent, ''), 'HeadlessChrome'), match(ifNull(properties.$user_agent, ''), 'PhantomJS'), match(ifNull(properties.$user_agent, ''), 'Puppeteer'), match(ifNull(properties.$user_agent, ''), 'Playwright'), match(ifNull(properties.$user_agent, ''), 'Selenium'), match(ifNull(properties.$user_agent, ''), '^$'))))
  ORDER BY
      user_agent ASC
  
  LIMIT 100
  '''
# ---
# name: TestTrafficTypeSnapshot.test_get_bot_name
  '''
  -- ClickHouse
  
  SELECT
      if(ifNull(equals(multiMatchAnyIndex(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_0)s), ''), 'null'), '^"|"$', ''), %(hogql_val_1)s), [%(hogql_val_2)s, %(hogql_val_3)s, %(hogql_val_4)s, %(hogql_val_5)s, %(hogql_val_6)s, %(hogql_val_7)s, %(hogql_val_8)s, %(hogql_val_9)s, %(hogql_val_10)s, %(hogql_val_11)s, %(hogql_val_12)s, %(hogql_val_13)s, %(hogql_val_14)s, %(hogql_val_15)s, %(hogql_val_16)s, %(hogql_val_17)s, %(hogql_val_18)s, %(hogql_val_19)s, %(hogql_val_20)s, %(hogql_val_21)s, %(hogql_val_22)s, %(hogql_val_23)s, %(hogql_val_24)s, %(hogql_val_25)s, %(hogql_val_26)s, %(hogql_val_27)s, %(hogql_val_28)s, %(hogql_val_29)s, %(hogql_val_30)s, %(hogql_val_31)s, %(hogql_val_32)s, %(hogql_val_33)s, %(hogql_val_34)s, %(hogql_val_35)s, %(hogql_val_36)s, %(hogql_val_37)s, %(hogql_val_38)s, %(hogql_val_39)s, %(hogql_val_40)s, %(hogql_val_41)s, %(hogql_val_42)s, %(hogql_val_43)s, %(hogql_val_44)s, %(hogql_val_45)s, %(hogql_val_46)s, %(hogql_val_47)s, %(hogql_val_48)s, %(hogql_val_49)s, %(hogql_val_50)s, %(hogql_val_51)s]), 0), 0), %(hogql_val_52)s, [%(hogql_val_53)s, %(hogql_val_54)s, %(hogql_val_55)s, %(hogql_val_56)s, %(hogql_val_57)s, %(hogql_val_58)s, %(hogql_val_59)s, %(hogql_val_60)s, %(hogql_val_61)s, %(hogql_val_62)s, %(hogql_val_63)s, %(hogql_val_64)s, %(hogql_val_65)s, %(hogql_val_66)s, %(hogql_val_67)s, %(hogql_val_68)s, %(hogql_val_69)s, %(hogql_val_70)s, %(hogql_val_71)s, %(hogql_val_72)s, %(hogql_val_73)s, %(hogql_val_74)s, %(hogql_val_75)s, %(hogql_val_76)s, %(hogql_val_77)s, %(hogql_val_78)s, %(hogql_val_79)s, %(hogql_val_80)s, %(hogql_val_81)s, %(hogql_val_82)s, %(hogql_val_83)s, %(hogql_val_84)s, %(hogql_val_85)s, %(hogql_val_86)s, %(hogql_val_87)s, %(hogql_val_88)s, %(hogql_val_89)s, %(hogql_val_90)s, %(hogql_val_91)s, %(hogql_val_92)s, %(hogql_val_93)s, %(hogql_val_94)s, %(hogql_val_95)s, %(hogql_val_96)s, %(hogql_val_97)s, %(hogql_val_98)s, %(hogql_val_99)s, %(hogql_val_100)s, %(hogql_val_101)s, %(hogql_val_102)s][multiMatchAnyIndex(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_103)s), ''), 'null'), '^"|"$', ''), %(hogql_val_104)s), [%(hogql_val_105)s, %(hogql_val_106)s, %(hogql_val_107)s, %(hogql_val_108)s, %(hogql_val_109)s, %(hogql_val_110)s, %(hogql_val_111)s, %(hogql_val_112)s, %(hogql_val_113)s, %(hogql_val_114)s, %(hogql_val_115)s, %(hogql_val_116)s, %(hogql_val_117)s, %(hogql_val_118)s, %(hogql_val_119)s, %(hogql_val_120)s, %(hogql_val_121)s, %(hogql_val_122)s, %(hogql_val_123)s, %(hogql_val_124)s, %(hogql_val_125)s, %(hogql_val_126)s, %(hogql_val_127)s, %(hogql_val_128)s, %(hogql_val_129)s, %(hogql_val_130)s, %(hogql_val_131)s, %(hogql_val_132)s, %(hogql_val_133)s, %(hogql_val_134)s, %(hogql_val_135)s, %(hogql_val_136)s, %(hogql_val_137)s, %(hogql_val_138)s, %(hogql_val_139)s, %(hogql_val_140)s, %(hogql_val_141)s, %(hogql_val_142)s, %(hogql_val_143)s, %(hogql_val_144)s, %(hogql_val_145)s, %(hogql_val_146)s, %(hogql_val_147)s, %(hogql_val_148)s, %(hogql_val_149)s, %(hogql_val_150)s, %(hogql_val_151)s, %(hogql_val_152)s, %(hogql_val_153)s, %(hogql_val_154)s])]) AS bot_name,
      count() AS count
  
  FROM
      events
  
  WHERE
      and(equals(events.team_id, 99999), equals(events.event, %(hogql_val_155)s))
  
  GROUP BY
      bot_name
  ORDER BY
      bot_name ASC
  
  LIMIT 100 
  SETTINGS readonly=2, max_execution_time=60, allow_experimental_object_type=1, format_csv_allow_double_quotes=0, max_ast_elements=4000000, max_expanded_ast_elements=4000000, max_bytes_before_external_group_by=0, transform_null_in=1, optimize_min_equality_disjunction_chain_length=4294967295, allow_experimental_join_condition=1, use_hive_partitioning=0
  
  -- HogQL
  
  SELECT
      if(equals(multiMatchAnyIndex(ifNull(properties.$user_agent, ''), ['GPTBot', 'ChatGPT-User', 'ClaudeBot', 'anthropic-ai', 'PerplexityBot', 'Google-Extended', 'CCBot', 'Applebot-Extended', 'cohere-ai', 'meta-externalagent', 'Bytespider', 'Googlebot', 'Bingbot', 'YandexBot', 'Baiduspider', 'DuckDuckBot', 'Slurp', 'AhrefsBot', 'SemrushBot', 'MJ12bot', 'DotBot', 'PetalBot', 'facebookexternalhit', 'Twitterbot', 'LinkedInBot', 'Pinterest', 'Slackbot', 'TelegramBot', 'WhatsApp', 'Pingdom', 'UptimeRobot', 'Site24x7', 'StatusCake', 'Datadog', 'curl/', 'Wget', 'python-requests', 'axios', 'node-fetch', 'Go-http-client', 'okhttp', 'Apache-HttpClient', 'libwww-perl', 'Scrapy', 'HeadlessChrome', 'PhantomJS', 'Puppeteer', 'Playwright', 'Selenium', '^$']), 0), '', ['GPTBot', 'ChatGPT', 'Claude', 'Anthropic', 'Perplexity', 'Google AI', 'Common Crawl', 'Apple AI', 'Cohere', 'Meta AI', 'ByteDance', 'Googlebot', 'Bingbot', 'Yandex', 'Baidu', 'DuckDuckGo', 'Yahoo', 'Ahrefs', 'Semrush', 'Majestic', 'Moz', 'Petal', 'Facebook', 'Twitter', 'LinkedIn', 'Pinterest', 'Slack', 'Telegram', 'WhatsApp', 'Pingdom', 'UptimeRobot', 'Site24x7', 'StatusCake', 'Datadog', 'curl', 'Wget', 'Python Requests', 'Axios', 'Node Fetch', 'Go HTTP', 'OkHttp', 'Apache HTTP', 'LWP', 'Scrapy', 'Headless Chrome', 'PhantomJS', 'Puppeteer', 'Playwright', 'Selenium', ''][multiMatchAnyIndex(ifNull(properties.$user_agent, ''), ['GPTBot', 'ChatGPT-User', 'ClaudeBot', 'anthropic-ai', 'PerplexityBot', 'Google-Extended', 'CCBot', 'Applebot-Extended', 'cohere-ai', 'meta-externalagent', 'Bytespider', 'Googlebot', 'Bingbot', 'YandexBot', 'Baiduspider', 'DuckDuckBot', 'Slurp', 'AhrefsBot', 'SemrushBot', 'MJ12bot', 'DotBot', 'PetalBot', 'facebookexternalhit', 'Twitterbot', 'LinkedInBot', 'Pinterest', 'Slackbot', 'TelegramBot', 'WhatsApp', 'Pingdom', 'UptimeRobot', 'Site24x7', 'StatusCake', 'Datadog', 'curl/', 'Wget', 'python-requests', 'axios', 'node-fetch', 'Go-http-client', 'okhttp', 'Apache-HttpClient', 'libwww-perl', 'Scrapy', 'HeadlessChrome', 'PhantomJS', 'Puppeteer', 'Playwright', 'Selenium', '^$'])]) AS bot_name,
      count() AS count
  
  FROM
      events
  
  WHERE
      equals(event, '$pageview')
  
  GROUP BY
      bot_name
  ORDER BY
      bot_name ASC
  
  LIMIT 100
  '''
# ---
# name: TestTrafficTypeSnapshot.test_get_bot_type
  '''
  -- ClickHouse
  
  SELECT
      if(ifNull(equals(multiMatchAnyIndex(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_0)s), ''), 'null'), '^"|"$', ''), %(hogql_val_1)s), [%(hogql_val_2)s, %(hogql_val_3)s, %(hogql_val_4)s, %(hogql_val_5)s, %(hogql_val_6)s, %(hogql_val_7)s, %(hogql_val_8)s, %(hogql_val_9)s, %(hogql_val_10)s, %(hogql_val_11)s, %(hogql_val_12)s, %(hogql_val_13)s, %(hogql_val_14)s, %(hogql_val_15)s, %(hogql_val_16)s, %(hogql_val_17)s, %(hogql_val_18)s, %(hogql_val_19)s, %(hogql_val_20)s, %(hogql_val_21)s, %(hogql_val_22)s, %(hogql_val_23)s, %(hogql_val_24)s, %(hogql_val_25)s, %(hogql_val_26)s, %(hogql_val_27)s, %(hogql_val_28)s, %(hogql_val_29)s, %(hogql_val_30)s, %(hogql_val_31)s, %(hogql_val_32)s, %(hogql_val_33)s, %(hogql_val_34)s, %(hogql_val_35)s, %(hogql_val_36)s, %(hogql_val_37)s, %(hogql_val_38)s, %(hogql_val_39)s, %(hogql_val_40)s, %(hogql_val_41)s, %(hogql_val_42)s, %(hogql_val_43)s, %(hogql_val_44)s, %(hogql_val_45)s, %(hogql_val_46)s, %(hogql_val_47)s, %(hogql_val_48)s, %(hogql_val_49)s, %(hogql_val_50)s, %(hogql_val_51)s]), 0), 0), %(hogql_val_52)s, [%(hogql_val_53)s, %(hogql_val_54)s, %(hogql_val_55)s, %(hogql_val_56)s, %(hogql_val_57)s, %(hogql_val_58)s, %(hogql_val_59)s, %(hogql_val_60)s, %(hogql_val_61)s, %(hogql_val_62)s, %(hogql_val_63)s, %(hogql_val_64)s, %(hogql_val_65)s, %(hogql_val_66)s, %(hogql_val_67)s, %(hogql_val_68)s, %(hogql_val_69)s, %(hogql_val_70)s, %(hogql_val_71)s, %(hogql_val_72)s, %(hogql_val_73)s, %(hogql_val_74)s, %(hogql_val_75)s, %(hogql_val_76)s, %(hogql_val_77)s, %(hogql_val_78)s, %(hogql_val_79)s, %(hogql_val_80)s, %(hogql_val_81)s, %(hogql_val_82)s, %(hogql_val_83)s, %(hogql_val_84)s, %(hogql_val_85)s, %(hogql_val_86)s, %(hogql_val_87)s, %(hogql_val_88)s, %(hogql_val_89)s, %(hogql_val_90)s, %(hogql_val_91)s, %(hogql_val_92)s, %(hogql_val_93)s, %(hogql_val_94)s, %(hogql_val_95)s, %(hogql_val_96)s, %(hogql_val_97)s, %(hogql_val_98)s, %(hogql_val_99)s, %(hogql_val_100)s, %(hogql_val_101)s, %(hogql_val_102)s][multiMatchAnyIndex(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_103)s), ''), 'null'), '^"|"$', ''), %(hogql_val_104)s), [%(hogql_val_105)s, %(hogql_val_106)s, %(hogql_val_107)s, %(hogql_val_108)s, %(hogql_val_109)s, %(hogql_val_110)s, %(hogql_val_111)s, %(hogql_val_112)s, %(hogql_val_113)s, %(hogql_val_114)s, %(hogql_val_115)s, %(hogql_val_116)s, %(hogql_val_117)s, %(hogql_val_118)s, %(hogql_val_119)s, %(hogql_val_120)s, %(hogql_val_121)s, %(hogql_val_122)s, %(hogql_val_123)s, %(hogql_val_124)s, %(hogql_val_125)s, %(hogql_val_126)s, %(hogql_val_127)s, %(hogql_val_128)s, %(hogql_val_129)s, %(hogql_val_130)s, %(hogql_val_131)s, %(hogql_val_132)s, %(hogql_val_133)s, %(hogql_val_134)s, %(hogql_val_135)s, %(hogql_val_136)s, %(hogql_val_137)s, %(hogql_val_138)s, %(hogql_val_139)s, %(hogql_val_140)s, %(hogql_val_141)s, %(hogql_val_142)s, %(hogql_val_143)s, %(hogql_val_144)s, %(hogql_val_145)s, %(hogql_val_146)s, %(hogql_val_147)s, %(hogql_val_148)s, %(hogql_val_149)s, %(hogql_val_150)s, %(hogql_val_151)s, %(hogql_val_152)s, %(hogql_val_153)s, %(hogql_val_154)s])]) AS bot_type,
      count() AS count
  
  FROM
      events
  
  WHERE
      and(equals(events.team_id, 99999), equals(events.event, %(hogql_val_155)s))
  
  GROUP BY
      bot_type
  ORDER BY
      bot_type ASC
  
  LIMIT 100 
  SETTINGS readonly=2, max_execution_time=60, allow_experimental_object_type=1, format_csv_allow_double_quotes=0, max_ast_elements=4000000, max_expanded_ast_elements=4000000, max_bytes_before_external_group_by=0, transform_null_in=1, optimize_min_equality_disjunction_chain_length=4294967295, allow_experimental_join_condition=1, use_hive_partitioning=0
  
  -- HogQL
  
  SELECT
      if(equals(multiMatchAnyIndex(ifNull(properties.$user_agent, ''), ['GPTBot', 'ChatGPT-User', 'ClaudeBot', 'anthropic-ai', 'PerplexityBot', 'Google-Extended', 'CCBot', 'Applebot-Extended', 'cohere-ai', 'meta-externalagent', 'Bytespider', 'Googlebot', 'Bingbot', 'YandexBot', 'Baiduspider', 'DuckDuckBot', 'Slurp', 'AhrefsBot', 'SemrushBot', 'MJ12bot', 'DotBot', 'PetalBot', 'facebookexternalhit', 'Twitterbot', 'LinkedInBot', 'Pinterest', 'Slackbot', 'TelegramBot', 'WhatsApp', 'Pingdom', 'UptimeRobot', 'Site24x7', 'StatusCake', 'Datadog', 'curl/', 'Wget', 'python-requests', 'axios', 'node-fetch', 'Go-http-client', 'okhttp', 'Apache-HttpClient', 'libwww-perl', 'Scrapy', 'HeadlessChrome', 'PhantomJS', 'Puppeteer', 'Playwright', 'Selenium', '^$']), 0), '', ['llm_crawler', 'llm_crawler', 'llm_crawler', 'llm_crawler', 'llm_crawler', 'llm_crawler', 'llm_crawler', 'llm_crawler', 'llm_crawler', 'llm_crawler', 'llm_crawler', 'search_crawler', 'search_crawler', 'search_crawler', 'search_crawler', 'search_crawler', 'search_crawler', 'seo_crawler', 'seo_crawler', 'seo_crawler', 'seo_crawler', 'seo_crawler', 'social_crawler', 'social_crawler', 'social_crawler', 'social_crawler', 'social_crawler', 'social_crawler', 'social_crawler', 'monitoring', 'monitoring', 'monitoring', 'monitoring', 'monitoring', 'http_client', 'http_client', 'http_client', 'http_client', 'http_client', 'http_client', 'http_client', 'http_client', 'http_client', 'http_client', 'headless_browser', 'headless_browser', 'headless_browser', 'headless_browser', 'headless_browser', 'no_user_agent'][multiMatchAnyIndex(ifNull(properties.$user_agent, ''), ['GPTBot', 'ChatGPT-User', 'ClaudeBot', 'anthropic-ai', 'PerplexityBot', 'Google-Extended', 'CCBot', 'Applebot-Extended', 'cohere-ai', 'meta-externalagent', 'Bytespider', 'Googlebot', 'Bingbot', 'YandexBot', 'Baiduspider', 'DuckDuckBot', 'Slurp', 'AhrefsBot', 'SemrushBot', 'MJ12bot', 'DotBot', 'PetalBot', 'facebookexternalhit', 'Twitterbot', 'LinkedInBot', 'Pinterest', 'Slackbot', 'TelegramBot', 'WhatsApp', 'Pingdom', 'UptimeRobot', 'Site24x7', 'StatusCake', 'Datadog', 'curl/', 'Wget', 'python-requests', 'axios', 'node-fetch', 'Go-http-client', 'okhttp', 'Apache-HttpClient', 'libwww-perl', 'Scrapy', 'HeadlessChrome', 'PhantomJS', 'Puppeteer', 'Playwright', 'Selenium', '^$'])]) AS bot_type,
      count() AS count
  
  FROM
      events
  
  WHERE
      equals(event, '$pageview')
  
  GROUP BY
      bot_type
  ORDER BY
      bot_type ASC
  
  LIMIT 100
  '''
# ---
# name: TestTrafficTypeSnapshot.test_get_traffic_category
  '''
  -- ClickHouse
  
  SELECT
      if(ifNull(equals(multiMatchAnyIndex(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_0)s), ''), 'null'), '^"|"$', ''), %(hogql_val_1)s), [%(hogql_val_2)s, %(hogql_val_3)s, %(hogql_val_4)s, %(hogql_val_5)s, %(hogql_val_6)s, %(hogql_val_7)s, %(hogql_val_8)s, %(hogql_val_9)s, %(hogql_val_10)s, %(hogql_val_11)s, %(hogql_val_12)s, %(hogql_val_13)s, %(hogql_val_14)s, %(hogql_val_15)s, %(hogql_val_16)s, %(hogql_val_17)s, %(hogql_val_18)s, %(hogql_val_19)s, %(hogql_val_20)s, %(hogql_val_21)s, %(hogql_val_22)s, %(hogql_val_23)s, %(hogql_val_24)s, %(hogql_val_25)s, %(hogql_val_26)s, %(hogql_val_27)s, %(hogql_val_28)s, %(hogql_val_29)s, %(hogql_val_30)s, %(hogql_val_31)s, %(hogql_val_32)s, %(hogql_val_33)s, %(hogql_val_34)s, %(hogql_val_35)s, %(hogql_val_36)s, %(hogql_val_37)s, %(hogql_val_38)s, %(hogql_val_39)s, %(hogql_val_40)s, %(hogql_val_41)s, %(hogql_val_42)s, %(hogql_val_43)s, %(hogql_val_44)s, %(hogql_val_45)s, %(hogql_val_46)s, %(hogql_val_47)s, %(hogql_val_48)s, %(hogql_val_49)s, %(hogql_val_50)s, %(hogql_val_51)s]), 0), 0), %(hogql_val_52)s, [%(hogql_val_53)s, %(hogql_val_54)s, %(hogql_val_55)s, %(hogql_val_56)s, %(hogql_val_57)s, %(hogql_val_58)s, %(hogql_val_59)s, %(hogql_val_60)s, %(hogql_val_61)s, %(hogql_val_62)s, %(hogql_val_63)s, %(hogql_val_64)s, %(hogql_val_65)s, %(hogql_val_66)s, %(hogql_val_67)s, %(hogql_val_68)s, %(hogql_val_69)s, %(hogql_val_70)s, %(hogql_val_71)s, %(hogql_val_72)s, %(hogql_val_73)s, %(hogql_val_74)s, %(hogql_val_75)s, %(hogql_val_76)s, %(hogql_val_77)s, %(hogql_val_78)s, %(hogql_val_79)s, %(hogql_val_80)s, %(hogql_val_81)s, %(hogql_val_82)s, %(hogql_val_83)s, %(hogql_val_84)s, %(hogql_val_85)s, %(hogql_val_86)s, %(hogql_val_87)s, %(hogql_val_88)s, %(hogql_val_89)s, %(hogql_val_90)s, %(hogql_val_91)s, %(hogql_val_92)s, %(hogql_val_93)s, %(hogql_val_94)s, %(hogql_val_95)s, %(hogql_val_96)s, %(hogql_val_97)s, %(hogql_val_98)s, %(hogql_val_99)s, %(hogql_val_100)s, %(hogql_val_101)s, %(hogql_val_102)s][multiMatchAnyIndex(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_103)s), ''), 'null'), '^"|"$', ''), %(hogql_val_104)s), [%(hogql_val_105)s, %(hogql_val_106)s, %(hogql_val_107)s, %(hogql_val_108)s, %(hogql_val_109)s, %(hogql_val_110)s, %(hogql_val_111)s, %(hogql_val_112)s, %(hogql_val_113)s, %(hogql_val_114)s, %(hogql_val_115)s, %(hogql_val_116)s, %(hogql_val_117)s, %(hogql_val_118)s, %(hogql_val_119)s, %(hogql_val_120)s, %(hogql_val_121)s, %(hogql_val_122)s, %(hogql_val_123)s, %(hogql_val_124)s, %(hogql_val_125)s, %(hogql_val_126)s, %(hogql_val_127)s, %(hogql_val_128)s, %(hogql_val_129)s, %(hogql_val_130)s, %(hogql_val_131)s, %(hogql_val_132)s, %(hogql_val_133)s, %(hogql_val_134)s, %(hogql_val_135)s, %(hogql_val_136)s, %(hogql_val_137)s, %(hogql_val_138)s, %(hogql_val_139)s, %(hogql_val_140)s, %(hogql_val_141)s, %(hogql_val_142)s, %(hogql_val_143)s, %(hogql_val_144)s, %(hogql_val_145)s, %(hogql_val_146)s, %(hogql_val_147)s, %(hogql_val_148)s, %(hogql_val_149)s, %(hogql_val_150)s, %(hogql_val_151)s, %(hogql_val_152)s, %(hogql_val_153)s, %(hogql_val_154)s])]) AS category,
      count() AS count
  
  FROM
      events
  
  WHERE
      and(equals(events.team_id, 99999), equals(events.event, %(hogql_val_155)s))
  
  GROUP BY
      category
  ORDER BY
      category ASC
  
  LIMIT 100 
  SETTINGS readonly=2, max_execution_time=60, allow_experimental_object_type=1, format_csv_allow_double_quotes=0, max_ast_elements=4000000, max_expanded_ast_elements=4000000, max_bytes_before_external_group_by=0, transform_null_in=1, optimize_min_equality_disjunction_chain_length=4294967295, allow_experimental_join_condition=1, use_hive_partitioning=0
  
  -- HogQL
  
  SELECT
      if(equals(multiMatchAnyIndex(ifNull(properties.$user_agent, ''), ['GPTBot', 'ChatGPT-User', 'ClaudeBot', 'anthropic-ai', 'PerplexityBot', 'Google-Extended', 'CCBot', 'Applebot-Extended', 'cohere-ai', 'meta-externalagent', 'Bytespider', 'Googlebot', 'Bingbot', 'YandexBot', 'Baiduspider', 'DuckDuckBot', 'Slurp', 'AhrefsBot', 'SemrushBot', 'MJ12bot', 'DotBot', 'PetalBot', 'facebookexternalhit', 'Twitterbot', 'LinkedInBot', 'Pinterest', 'Slackbot', 'TelegramBot', 'WhatsApp', 'Pingdom', 'UptimeRobot', 'Site24x7', 'StatusCake', 'Datadog', 'curl/', 'Wget', 'python-requests', 'axios', 'node-fetch', 'Go-http-client', 'okhttp', 'Apache-HttpClient', 'libwww-perl', 'Scrapy', 'HeadlessChrome', 'PhantomJS', 'Puppeteer', 'Playwright', 'Selenium', '^$']), 0), 'regular', ['llm_crawler', 'llm_crawler', 'llm_crawler', 'llm_crawler', 'llm_crawler', 'llm_crawler', 'llm_crawler', 'llm_crawler', 'llm_crawler', 'llm_crawler', 'llm_crawler', 'search_crawler', 'search_crawler', 'search_crawler', 'search_crawler', 'search_crawler', 'search_crawler', 'seo_crawler', 'seo_crawler', 'seo_crawler', 'seo_crawler', 'seo_crawler', 'social_crawler', 'social_crawler', 'social_crawler', 'social_crawler', 'social_crawler', 'social_crawler', 'social_crawler', 'monitoring', 'monitoring', 'monitoring', 'monitoring', 'monitoring', 'http_client', 'http_client', 'http_client', 'http_client', 'http_client', 'http_client', 'http_client', 'http_client', 'http_client', 'http_client', 'headless_browser', 'headless_browser', 'headless_browser', 'headless_browser', 'headless_browser', 'no_user_agent'][multiMatchAnyIndex(ifNull(properties.$user_agent, ''), ['GPTBot', 'ChatGPT-User', 'ClaudeBot', 'anthropic-ai', 'PerplexityBot', 'Google-Extended', 'CCBot', 'Applebot-Extended', 'cohere-ai', 'meta-externalagent', 'Bytespider', 'Googlebot', 'Bingbot', 'YandexBot', 'Baiduspider', 'DuckDuckBot', 'Slurp', 'AhrefsBot', 'SemrushBot', 'MJ12bot', 'DotBot', 'PetalBot', 'facebookexternalhit', 'Twitterbot', 'LinkedInBot', 'Pinterest', 'Slackbot', 'TelegramBot', 'WhatsApp', 'Pingdom', 'UptimeRobot', 'Site24x7', 'StatusCake', 'Datadog', 'curl/', 'Wget', 'python-requests', 'axios', 'node-fetch', 'Go-http-client', 'okhttp', 'Apache-HttpClient', 'libwww-perl', 'Scrapy', 'HeadlessChrome', 'PhantomJS', 'Puppeteer', 'Playwright', 'Selenium', '^$'])]) AS category,
      count() AS count
  
  FROM
      events
  
  WHERE
      equals(event, '$pageview')
  
  GROUP BY
      category
  ORDER BY
      category ASC
  
  LIMIT 100
  '''
# ---
# name: TestTrafficTypeSnapshot.test_get_traffic_type
  '''
  -- ClickHouse
  
  SELECT
      if(ifNull(equals(multiMatchAnyIndex(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_0)s), ''), 'null'), '^"|"$', ''), %(hogql_val_1)s), [%(hogql_val_2)s, %(hogql_val_3)s, %(hogql_val_4)s, %(hogql_val_5)s, %(hogql_val_6)s, %(hogql_val_7)s, %(hogql_val_8)s, %(hogql_val_9)s, %(hogql_val_10)s, %(hogql_val_11)s, %(hogql_val_12)s, %(hogql_val_13)s, %(hogql_val_14)s, %(hogql_val_15)s, %(hogql_val_16)s, %(hogql_val_17)s, %(hogql_val_18)s, %(hogql_val_19)s, %(hogql_val_20)s, %(hogql_val_21)s, %(hogql_val_22)s, %(hogql_val_23)s, %(hogql_val_24)s, %(hogql_val_25)s, %(hogql_val_26)s, %(hogql_val_27)s, %(hogql_val_28)s, %(hogql_val_29)s, %(hogql_val_30)s, %(hogql_val_31)s, %(hogql_val_32)s, %(hogql_val_33)s, %(hogql_val_34)s, %(hogql_val_35)s, %(hogql_val_36)s, %(hogql_val_37)s, %(hogql_val_38)s, %(hogql_val_39)s, %(hogql_val_40)s, %(hogql_val_41)s, %(hogql_val_42)s, %(hogql_val_43)s, %(hogql_val_44)s, %(hogql_val_45)s, %(hogql_val_46)s, %(hogql_val_47)s, %(hogql_val_48)s, %(hogql_val_49)s, %(hogql_val_50)s, %(hogql_val_51)s]), 0), 0), %(hogql_val_52)s, [%(hogql_val_53)s, %(hogql_val_54)s, %(hogql_val_55)s, %(hogql_val_56)s, %(hogql_val_57)s, %(hogql_val_58)s, %(hogql_val_59)s, %(hogql_val_60)s, %(hogql_val_61)s, %(hogql_val_62)s, %(hogql_val_63)s, %(hogql_val_64)s, %(hogql_val_65)s, %(hogql_val_66)s, %(hogql_val_67)s, %(hogql_val_68)s, %(hogql_val_69)s, %(hogql_val_70)s, %(hogql_val_71)s, %(hogql_val_72)s, %(hogql_val_73)s, %(hogql_val_74)s, %(hogql_val_75)s, %(hogql_val_76)s, %(hogql_val_77)s, %(hogql_val_78)s, %(hogql_val_79)s, %(hogql_val_80)s, %(hogql_val_81)s, %(hogql_val_82)s, %(hogql_val_83)s, %(hogql_val_84)s, %(hogql_val_85)s, %(hogql_val_86)s, %(hogql_val_87)s, %(hogql_val_88)s, %(hogql_val_89)s, %(hogql_val_90)s, %(hogql_val_91)s, %(hogql_val_92)s, %(hogql_val_93)s, %(hogql_val_94)s, %(hogql_val_95)s, %(hogql_val_96)s, %(hogql_val_97)s, %(hogql_val_98)s, %(hogql_val_99)s, %(hogql_val_100)s, %(hogql_val_101)s, %(hogql_val_102)s][multiMatchAnyIndex(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_103)s), ''), 'null'), '^"|"$', ''), %(hogql_val_104)s), [%(hogql_val_105)s, %(hogql_val_106)s, %(hogql_val_107)s, %(hogql_val_108)s, %(hogql_val_109)s, %(hogql_val_110)s, %(hogql_val_111)s, %(hogql_val_112)s, %(hogql_val_113)s, %(hogql_val_114)s, %(hogql_val_115)s, %(hogql_val_116)s, %(hogql_val_117)s, %(hogql_val_118)s, %(hogql_val_119)s, %(hogql_val_120)s, %(hogql_val_121)s, %(hogql_val_122)s, %(hogql_val_123)s, %(hogql_val_124)s, %(hogql_val_125)s, %(hogql_val_126)s, %(hogql_val_127)s, %(hogql_val_128)s, %(hogql_val_129)s, %(hogql_val_130)s, %(hogql_val_131)s, %(hogql_val_132)s, %(hogql_val_133)s, %(hogql_val_134)s, %(hogql_val_135)s, %(hogql_val_136)s, %(hogql_val_137)s, %(hogql_val_138)s, %(hogql_val_139)s, %(hogql_val_140)s, %(hogql_val_141)s, %(hogql_val_142)s, %(hogql_val_143)s, %(hogql_val_144)s, %(hogql_val_145)s, %(hogql_val_146)s, %(hogql_val_147)s, %(hogql_val_148)s, %(hogql_val_149)s, %(hogql_val_150)s, %(hogql_val_151)s, %(hogql_val_152)s, %(hogql_val_153)s, %(hogql_val_154)s])]) AS traffic_type,
      count() AS count
  
  FROM
      events
  
  WHERE
      and(equals(events.team_id, 99999), equals(events.event, %(hogql_val_155)s))
  
  GROUP BY
      traffic_type
  ORDER BY
      traffic_type ASC
  
  LIMIT 100 
  SETTINGS readonly=2, max_execution_time=60, allow_experimental_object_type=1, format_csv_allow_double_quotes=0, max_ast_elements=4000000, max_expanded_ast_elements=4000000, max_bytes_before_external_group_by=0, transform_null_in=1, optimize_min_equality_disjunction_chain_length=4294967295, allow_experimental_join_condition=1, use_hive_partitioning=0
  
  -- HogQL
  
  SELECT
      if(equals(multiMatchAnyIndex(ifNull(properties.$user_agent, ''), ['GPTBot', 'ChatGPT-User', 'ClaudeBot', 'anthropic-ai', 'PerplexityBot', 'Google-Extended', 'CCBot', 'Applebot-Extended', 'cohere-ai', 'meta-externalagent', 'Bytespider', 'Googlebot', 'Bingbot', 'YandexBot', 'Baiduspider', 'DuckDuckBot', 'Slurp', 'AhrefsBot', 'SemrushBot', 'MJ12bot', 'DotBot', 'PetalBot', 'facebookexternalhit', 'Twitterbot', 'LinkedInBot', 'Pinterest', 'Slackbot', 'TelegramBot', 'WhatsApp', 'Pingdom', 'UptimeRobot', 'Site24x7', 'StatusCake', 'Datadog', 'curl/', 'Wget', 'python-requests', 'axios', 'node-fetch', 'Go-http-client', 'okhttp', 'Apache-HttpClient', 'libwww-perl', 'Scrapy', 'HeadlessChrome', 'PhantomJS', 'Puppeteer', 'Playwright', 'Selenium', '^$']), 0), 'Regular', ['AI Agent', 'AI Agent', 'AI Agent', 'AI Agent', 'AI Agent', 'AI Agent', 'AI Agent', 'AI Agent', 'AI Agent', 'AI Agent', 'AI Agent', 'Bot', 'Bot', 'Bot', 'Bot', 'Bot', 'Bot', 'Bot', 'Bot', 'Bot', 'Bot', 'Bot', 'Bot', 'Bot', 'Bot', 'Bot', 'Bot', 'Bot', 'Bot', 'Bot', 'Bot', 'Bot', 'Bot', 'Bot', 'Automation', 'Automation', 'Automation', 'Automation', 'Automation', 'Automation', 'Automation', 'Automation', 'Automation', 'Automation', 'Automation', 'Automation', 'Automation', 'Automation', 'Automation', 'Automation'][multiMatchAnyIndex(ifNull(properties.$user_agent, ''), ['GPTBot', 'ChatGPT-User', 'ClaudeBot', 'anthropic-ai', 'PerplexityBot', 'Google-Extended', 'CCBot', 'Applebot-Extended', 'cohere-ai', 'meta-externalagent', 'Bytespider', 'Googlebot', 'Bingbot', 'YandexBot', 'Baiduspider', 'DuckDuckBot', 'Slurp', 'AhrefsBot', 'SemrushBot', 'MJ12bot', 'DotBot', 'PetalBot', 'facebookexternalhit', 'Twitterbot', 'LinkedInBot', 'Pinterest', 'Slackbot', 'TelegramBot', 'WhatsApp', 'Pingdom', 'UptimeRobot', 'Site24x7', 'StatusCake', 'Datadog', 'curl/', 'Wget', 'python-requests', 'axios', 'node-fetch', 'Go-http-client', 'okhttp', 'Apache-HttpClient', 'libwww-perl', 'Scrapy', 'HeadlessChrome', 'PhantomJS', 'Puppeteer', 'Playwright', 'Selenium', '^$'])]) AS traffic_type,
      count() AS count
  
  FROM
      events
  
  WHERE
      equals(event, '$pageview')
  
  GROUP BY
      traffic_type
  ORDER BY
      traffic_type ASC
  
  LIMIT 100
  '''
# ---
# name: TestTrafficTypeSnapshot.test_is_bot
  '''
  -- ClickHouse
  
  SELECT
      or(match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_0)s), ''), 'null'), '^"|"$', ''), %(hogql_val_1)s), %(hogql_val_2)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_3)s), ''), 'null'), '^"|"$', ''), %(hogql_val_4)s), %(hogql_val_5)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_6)s), ''), 'null'), '^"|"$', ''), %(hogql_val_7)s), %(hogql_val_8)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_9)s), ''), 'null'), '^"|"$', ''), %(hogql_val_10)s), %(hogql_val_11)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_12)s), ''), 'null'), '^"|"$', ''), %(hogql_val_13)s), %(hogql_val_14)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_15)s), ''), 'null'), '^"|"$', ''), %(hogql_val_16)s), %(hogql_val_17)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_18)s), ''), 'null'), '^"|"$', ''), %(hogql_val_19)s), %(hogql_val_20)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_21)s), ''), 'null'), '^"|"$', ''), %(hogql_val_22)s), %(hogql_val_23)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_24)s), ''), 'null'), '^"|"$', ''), %(hogql_val_25)s), %(hogql_val_26)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_27)s), ''), 'null'), '^"|"$', ''), %(hogql_val_28)s), %(hogql_val_29)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_30)s), ''), 'null'), '^"|"$', ''), %(hogql_val_31)s), %(hogql_val_32)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_33)s), ''), 'null'), '^"|"$', ''), %(hogql_val_34)s), %(hogql_val_35)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_36)s), ''), 'null'), '^"|"$', ''), %(hogql_val_37)s), %(hogql_val_38)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_39)s), ''), 'null'), '^"|"$', ''), %(hogql_val_40)s), %(hogql_val_41)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_42)s), ''), 'null'), '^"|"$', ''), %(hogql_val_43)s), %(hogql_val_44)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_45)s), ''), 'null'), '^"|"$', ''), %(hogql_val_46)s), %(hogql_val_47)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_48)s), ''), 'null'), '^"|"$', ''), %(hogql_val_49)s), %(hogql_val_50)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_51)s), ''), 'null'), '^"|"$', ''), %(hogql_val_52)s), %(hogql_val_53)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_54)s), ''), 'null'), '^"|"$', ''), %(hogql_val_55)s), %(hogql_val_56)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_57)s), ''), 'null'), '^"|"$', ''), %(hogql_val_58)s), %(hogql_val_59)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_60)s), ''), 'null'), '^"|"$', ''), %(hogql_val_61)s), %(hogql_val_62)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_63)s), ''), 'null'), '^"|"$', ''), %(hogql_val_64)s), %(hogql_val_65)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_66)s), ''), 'null'), '^"|"$', ''), %(hogql_val_67)s), %(hogql_val_68)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_69)s), ''), 'null'), '^"|"$', ''), %(hogql_val_70)s), %(hogql_val_71)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_72)s), ''), 'null'), '^"|"$', ''), %(hogql_val_73)s), %(hogql_val_74)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_75)s), ''), 'null'), '^"|"$', ''), %(hogql_val_76)s), %(hogql_val_77)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_78)s), ''), 'null'), '^"|"$', ''), %(hogql_val_79)s), %(hogql_val_80)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_81)s), ''), 'null'), '^"|"$', ''), %(hogql_val_82)s), %(hogql_val_83)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_84)s), ''), 'null'), '^"|"$', ''), %(hogql_val_85)s), %(hogql_val_86)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_87)s), ''), 'null'), '^"|"$', ''), %(hogql_val_88)s), %(hogql_val_89)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_90)s), ''), 'null'), '^"|"$', ''), %(hogql_val_91)s), %(hogql_val_92)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_93)s), ''), 'null'), '^"|"$', ''), %(hogql_val_94)s), %(hogql_val_95)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_96)s), ''), 'null'), '^"|"$', ''), %(hogql_val_97)s), %(hogql_val_98)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_99)s), ''), 'null'), '^"|"$', ''), %(hogql_val_100)s), %(hogql_val_101)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_102)s), ''), 'null'), '^"|"$', ''), %(hogql_val_103)s), %(hogql_val_104)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_105)s), ''), 'null'), '^"|"$', ''), %(hogql_val_106)s), %(hogql_val_107)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_108)s), ''), 'null'), '^"|"$', ''), %(hogql_val_109)s), %(hogql_val_110)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_111)s), ''), 'null'), '^"|"$', ''), %(hogql_val_112)s), %(hogql_val_113)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_114)s), ''), 'null'), '^"|"$', ''), %(hogql_val_115)s), %(hogql_val_116)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_117)s), ''), 'null'), '^"|"$', ''), %(hogql_val_118)s), %(hogql_val_119)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_120)s), ''), 'null'), '^"|"$', ''), %(hogql_val_121)s), %(hogql_val_122)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_123)s), ''), 'null'), '^"|"$', ''), %(hogql_val_124)s), %(hogql_val_125)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_126)s), ''), 'null'), '^"|"$', ''), %(hogql_val_127)s), %(hogql_val_128)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_129)s), ''), 'null'), '^"|"$', ''), %(hogql_val_130)s), %(hogql_val_131)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_132)s), ''), 'null'), '^"|"$', ''), %(hogql_val_133)s), %(hogql_val_134)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_135)s), ''), 'null'), '^"|"$', ''), %(hogql_val_136)s), %(hogql_val_137)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_138)s), ''), 'null'), '^"|"$', ''), %(hogql_val_139)s), %(hogql_val_140)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_141)s), ''), 'null'), '^"|"$', ''), %(hogql_val_142)s), %(hogql_val_143)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_144)s), ''), 'null'), '^"|"$', ''), %(hogql_val_145)s), %(hogql_val_146)s), match(ifNull(replaceRegexpAll(nullIf(nullIf(JSONExtractRaw(events.properties, %(hogql_val_147)s), ''), 'null'), '^"|"$', ''), %(hogql_val_148)s), %(hogql_val_149)s)) AS is_bot,
      count() AS count
  
  FROM
      events
  
  WHERE
      and(equals(events.team_id, 99999), equals(events.event, %(hogql_val_150)s))
  
  GROUP BY
      is_bot
  ORDER BY
      is_bot ASC
  
  LIMIT 100 
  SETTINGS readonly=2, max_execution_time=60, allow_experimental_object_type=1, format_csv_allow_double_quotes=0, max_ast_elements=4000000, max_expanded_ast_elements=4000000, max_bytes_before_external_group_by=0, transform_null_in=1, optimize_min_equality_disjunction_chain_length=4294967295, allow_experimental_join_condition=1, use_hive_partitioning=0
  
  -- HogQL
  
  SELECT
      or(match(ifNull(properties.$user_agent, ''), 'GPTBot'), match(ifNull(properties.$user_agent, ''), 'ChatGPT-User'), match(ifNull(properties.$user_agent, ''), 'ClaudeBot'), match(ifNull(properties.$user_agent, ''), 'anthropic-ai'), match(ifNull(properties.$user_agent, ''), 'PerplexityBot'), match(ifNull(properties.$user_agent, ''), 'Google-Extended'), match(ifNull(properties.$user_agent, ''), 'CCBot'), match(ifNull(properties.$user_agent, ''), 'Applebot-Extended'), match(ifNull(properties.$user_agent, ''), 'cohere-ai'), match(ifNull(properties.$user_agent, ''), 'meta-externalagent'), match(ifNull(properties.$user_agent, ''), 'Bytespider'), match(ifNull(properties.$user_agent, ''), 'Googlebot'), match(ifNull(properties.$user_agent, ''), 'Bingbot'), match(ifNull(properties.$user_agent, ''), 'YandexBot'), match(ifNull(properties.$user_agent, ''), 'Baiduspider'), match(ifNull(properties.$user_agent, ''), 'DuckDuckBot'), match(ifNull(properties.$user_agent, ''), 'Slurp'), match(ifNull(properties.$user_agent, ''), 'AhrefsBot'), match(ifNull(properties.$user_agent, ''), 'SemrushBot'), match(ifNull(properties.$user_agent, ''), 'MJ12bot'), match(ifNull(properties.$user_agent, ''), 'DotBot'), match(ifNull(properties.$user_agent, ''), 'PetalBot'), match(ifNull(properties.$user_agent, ''), 'facebookexternalhit'), match(ifNull(properties.$user_agent, ''), 'Twitterbot'), match(ifNull(properties.$user_agent, ''), 'LinkedInBot'), match(ifNull(properties.$user_agent, ''), 'Pinterest'), match(ifNull(properties.$user_agent, ''), 'Slackbot'), match(ifNull(properties.$user_agent, ''), 'TelegramBot'), match(ifNull(properties.$user_agent, ''), 'WhatsApp'), match(ifNull(properties.$user_agent, ''), 'Pingdom'), match(ifNull(properties.$user_agent, ''), 'UptimeRobot'), match(ifNull(properties.$user_agent, ''), 'Site24x7'), match(ifNull(properties.$user_agent, ''), 'StatusCake'), match(ifNull(properties.$user_agent, ''), 'Datadog'), match(ifNull(properties.$user_agent, ''), 'curl/'), match(ifNull(properties.$user_agent, ''), 'Wget'), match(ifNull(properties.$user_agent, ''), 'python-requests'), match(ifNull(properties.$user_agent, ''), 'axios'), match(ifNull(properties.$user_agent, ''), 'node-fetch'), match(ifNull(properties.$user_agent, ''), 'Go-http-client'), match(ifNull(properties.$user_agent, ''), 'okhttp'), match(ifNull(properties.$user_agent, ''), 'Apache-HttpClient'), match(ifNull(properties.$user_agent, ''), 'libwww-perl'), match(ifNull(properties.$user_agent, ''), 'Scrapy'), match(ifNull(properties.$user_agent, ''), 'HeadlessChrome'), match(ifNull(properties.$user_agent, ''), 'PhantomJS'), match(ifNull(properties.$user_agent, ''), 'Puppeteer'), match(ifNull(properties.$user_agent, ''), 'Playwright'), match(ifNull(properties.$user_agent, ''), 'Selenium'), match(ifNull(properties.$user_agent, ''), '^$')) AS is_bot,
      count() AS count
  
  FROM
      events
  
  WHERE
      equals(event, '$pageview')
  
  GROUP BY
      is_bot
  ORDER BY
      is_bot ASC
  
  LIMIT 100
  '''
# ---
